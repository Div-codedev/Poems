<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Poetry Scrapbook</title>
    <link href="https://fonts.googleapis.com/css2?family=Gloock:wght@400&family=Kalam:wght@300;400;700&display=swap" rel="stylesheet">
    <script src="https://esm.sh/animejs@3.2.1"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Gloock', serif;
            overflow: hidden;
            height: 100vh;
            width: 100vw;
            background: radial-gradient(ellipse at center, #2a2a2a 0%, #1a1a1a 100%);
            position: relative;
        }

        /* Dark dotted radial background */
        body::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                radial-gradient(circle at 25% 25%, rgba(255,255,255,0.1) 1px, transparent 1px),
                radial-gradient(circle at 75% 75%, rgba(255,255,255,0.05) 1px, transparent 1px);
            background-size: 60px 60px, 90px 90px;
            pointer-events: none;
            z-index: 0;
        }

        .container {
            position: relative;
            width: 100vw;
            height: 100vh;
            overflow: hidden;
            z-index: 1;
        }

        .sticky-note {
            position: absolute;
            width: 280px;
            height: 200px;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.3), 0 4px 10px rgba(0,0,0,0.2);
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            transform-origin: center;
            opacity: 0;
            z-index: 2;
        }

        .sticky-note:hover {
            transform: scale(1.05) rotate(0deg) !important;
            box-shadow: 0 15px 35px rgba(0,0,0,0.4), 0 8px 15px rgba(0,0,0,0.3);
            z-index: 3;
        }

        .sticky-note.yellow {
            background: linear-gradient(135deg, #fff9c4 0%, #f5e6a8 50%, #e8d58a 100%);
        }

        .sticky-note.mint {
            background: linear-gradient(135deg, #d4f4dd 0%, #b8e6c1 50%, #9dd9a3 100%);
        }

        .sticky-note.peach {
            background: linear-gradient(135deg, #ffd6cc 0%, #ffb8a8 50%, #ff9a84 100%);
        }

        .sticky-note.lavender {
            background: linear-gradient(135deg, #e8d8ff 0%, #d4c4ff 50%, #c0b0ff 100%);
        }

        .sticky-note.coral {
            background: linear-gradient(135deg, #ffcccc 0%, #ffb3b3 50%, #ff9999 100%);
        }

        .note-content {
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            position: relative;
            overflow: hidden;
        }

        .note-title {
            font-size: 18px;
            font-weight: 400;
            color: #2a2a2a;
            margin-bottom: 12px;
            line-height: 1.3;
            text-shadow: 0 1px 2px rgba(255,255,255,0.8);
        }

        .note-preview {
            font-family: 'Kalam', cursive;
            font-size: 14px;
            color: #4a4a4a;
            line-height: 1.4;
            position: relative;
            flex-grow: 1;
            mask-image: linear-gradient(to bottom, rgba(0,0,0,1) 0%, rgba(0,0,0,1) 60%, rgba(0,0,0,0.3) 85%, rgba(0,0,0,0) 100%);
            -webkit-mask-image: linear-gradient(to bottom, rgba(0,0,0,1) 0%, rgba(0,0,0,1) 60%, rgba(0,0,0,0.3) 85%, rgba(0,0,0,0) 100%);
        }

        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(0,0,0,0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: linear-gradient(145deg, #f8f6f0 0%, #ede8dc 50%, #e2dcc8 100%);
            padding: 40px;
            border-radius: 15px;
            max-width: 90vw;
            max-height: 90vh;
            width: 600px;
            box-shadow: 
                0 25px 60px rgba(0,0,0,0.3),
                0 12px 30px rgba(0,0,0,0.2),
                inset 0 1px 0 rgba(255,255,255,0.9);
            position: relative;
            overflow-y: auto;
            transform: scale(0.8);
            opacity: 0;
        }

        .modal-close {
            position: absolute;
            top: 15px;
            right: 20px;
            background: none;
            border: none;
            font-size: 28px;
            color: #666;
            cursor: pointer;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .modal-close:hover {
            background: rgba(0,0,0,0.1);
            color: #333;
        }

        .modal-title {
            font-size: 28px;
            color: #2a2a2a;
            margin-bottom: 25px;
            text-align: center;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .modal-body {
            font-family: 'Kalam', cursive;
            font-size: 16px;
            line-height: 1.8;
            color: #3a3a3a;
            white-space: pre-line;
            text-align: center;
        }

        /* Loading spinner */
        .loading {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 18px;
            color: #fff;
            z-index: 10;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(255,255,255,0.1);
            border-top: 4px solid #fff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Mobile responsiveness */
        @media (max-width: 768px) {
            .sticky-note {
                width: 240px;
                height: 180px;
                padding: 16px;
            }

            .note-title {
                font-size: 16px;
                margin-bottom: 10px;
            }

            .note-preview {
                font-size: 13px;
            }

            .modal-content {
                padding: 30px 25px;
                margin: 20px;
                width: calc(100vw - 40px);
            }

            .modal-title {
                font-size: 24px;
                margin-bottom: 20px;
            }

            .modal-body {
                font-size: 15px;
                line-height: 1.7;
            }
        }

        @media (max-width: 480px) {
            .sticky-note {
                width: 200px;
                height: 160px;
                padding: 14px;
            }

            .note-title {
                font-size: 15px;
            }

            .note-preview {
                font-size: 12px;
            }
        }

        /* Error message */
        .error-message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255,255,255,0.95);
            padding: 30px;
            border-radius: 10px;
            text-align: center;
            color: #666;
            font-size: 16px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            z-index: 10;
        }
    </style>
</head>
<body>
    <div class="container" id="container">
        <div class="loading" id="loading">
            <div class="spinner"></div>
            Loading poetry...
        </div>
    </div>

    <!-- Modal -->
    <div class="modal-overlay" id="modalOverlay">
        <div class="modal-content" id="modalContent">
            <button class="modal-close" id="modalClose">&times;</button>
            <h2 class="modal-title" id="modalTitle"></h2>
            <div class="modal-body" id="modalBody"></div>
        </div>
    </div>

    <script>
        class PoetryScrapbook {
            constructor() {
                this.poems = [];
                this.colors = ['yellow', 'mint', 'peach', 'lavender', 'coral'];
                this.container = document.getElementById('container');
                this.loading = document.getElementById('loading');
                this.modalOverlay = document.getElementById('modalOverlay');
                this.modalContent = document.getElementById('modalContent');
                this.modalTitle = document.getElementById('modalTitle');
                this.modalBody = document.getElementById('modalBody');
                this.modalClose = document.getElementById('modalClose');
                
                this.init();
            }

            async init() {
                try {
                    await this.loadPoems();
                    this.hideLoading();
                    this.createStickyNotes();
                    this.setupEventListeners();
                } catch (error) {
                    this.showError('Failed to load poems. Please ensure poems.json exists and is properly formatted.');
                }
            }

            async loadPoems() {
                try {
                    const response = await fetch('poems.json');
                    if (!response.ok) {
                        throw new Error('Failed to fetch poems');
                    }
                    this.poems = await response.json();
                } catch (error) {
                    // Fallback sample data for demonstration
                    this.poems = [
                        {
                            title: "Whispers of Dawn",
                            preview: "In the gentle morning light, dreams take flight on golden wings...",
                            body: "In the gentle morning light,\nDreams take flight on golden wings,\nWhispering secrets to the dawn,\nOf all the hope tomorrow brings.\n\nSoft shadows dance on dewy grass,\nAs silence holds the world in grace,\nEach moment flows like morning mist,\nLeaving wonder in its place.",
                            color: "yellow"
                        },
                        {
                            title: "Ocean's Memory",
                            preview: "Salt-kissed shores remember tales of distant lands and forgotten sails...",
                            body: "Salt-kissed shores remember tales\nOf distant lands and forgotten sails,\nWaves carry stories from the deep,\nSecrets that the ocean keeps.\n\nSeashells scattered on the sand\nHold memories of another land,\nEach tide that touches weathered stone\nBrings whispers from the unknown.",
                            color: "mint"
                        },
                        {
                            title: "Evening Reverie",
                            preview: "When twilight paints the sky in hues of amber and rose...",
                            body: "When twilight paints the sky\nIn hues of amber and rose,\nThe world grows soft and still,\nAs gentle evening flows.\n\nStars begin their ancient dance\nAcross the velvet night,\nWhile dreams prepare to take their flight\nOn wings of silver light.",
                            color: "peach"
                        }
                    ];
                }
            }

            hideLoading() {
                this.loading.style.display = 'none';
            }

            showError(message) {
                this.loading.innerHTML = `<div class="error-message">${message}</div>`;
            }

            createStickyNotes() {
                const viewportWidth = window.innerWidth;
                const viewportHeight = window.innerHeight;
                
                this.poems.forEach((poem, index) => {
                    const note = this.createStickyNote(poem, index);
                    this.positionNote(note, index, viewportWidth, viewportHeight);
                    this.container.appendChild(note);
                    
                    // Animate entrance
                    anime({
                        targets: note,
                        opacity: [0, 1],
                        scale: [0.8, 1],
                        rotate: note.style.transform.match(/rotate\(([^)]+)\)/)?.[1] || '0deg',
                        delay: index * 200,
                        duration: 800,
                        easing: 'easeOutElastic(1, .8)'
                    });
                });
            }

            createStickyNote(poem, index) {
                const note = document.createElement('div');
                note.className = `sticky-note ${poem.color || this.colors[index % this.colors.length]}`;
                
                const rotation = (Math.random() - 0.5) * 30; // -15 to 15 degrees
                note.style.transform = `rotate(${rotation}deg)`;
                
                note.innerHTML = `
                    <div class="note-content">
                        <h3 class="note-title">${poem.title}</h3>
                        <p class="note-preview">${poem.preview}</p>
                    </div>
                `;
                
                note.addEventListener('click', () => this.openModal(poem));
                
                return note;
            }

            positionNote(note, index, viewportWidth, viewportHeight) {
                const noteWidth = 280;
                const noteHeight = 200;
                const margin = 50;
                
                let x, y;
                let attempts = 0;
                const maxAttempts = 50;
                
                do {
                    x = Math.random() * (viewportWidth - noteWidth - 2 * margin) + margin;
                    y = Math.random() * (viewportHeight - noteHeight - 2 * margin) + margin;
                    attempts++;
                } while (attempts < maxAttempts && this.isOverlapping(x, y, noteWidth, noteHeight));
                
                note.style.left = `${x}px`;
                note.style.top = `${y}px`;
            }

            isOverlapping(x, y, width, height) {
                const existingNotes = this.container.querySelectorAll('.sticky-note');
                
                for (let existingNote of existingNotes) {
                    const rect = existingNote.getBoundingClientRect();
                    const ex = parseFloat(existingNote.style.left);
                    const ey = parseFloat(existingNote.style.top);
                    
                    if (x < ex + width + 20 && x + width + 20 > ex &&
                        y < ey + height + 20 && y + height + 20 > ey) {
                        return true;
                    }
                }
                return false;
            }

            openModal(poem) {
                this.modalTitle.textContent = poem.title;
                this.modalBody.textContent = poem.body;
                this.modalOverlay.style.display = 'flex';
                
                // Animate modal entrance
                anime({
                    targets: this.modalContent,
                    scale: [0.8, 1],
                    opacity: [0, 1],
                    duration: 500,
                    easing: 'easeOutCubic'
                });
            }

            closeModal() {
                anime({
                    targets: this.modalContent,
                    scale: [1, 0.8],
                    opacity: [1, 0],
                    duration: 300,
                    easing: 'easeInCubic',
                    complete: () => {
                        this.modalOverlay.style.display = 'none';
                    }
                });
            }

            setupEventListeners() {
                this.modalClose.addEventListener('click', () => this.closeModal());
                
                this.modalOverlay.addEventListener('click', (e) => {
                    if (e.target === this.modalOverlay) {
                        this.closeModal();
                    }
                });
                
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape' && this.modalOverlay.style.display === 'flex') {
                        this.closeModal();
                    }
                });

                // Handle window resize
                window.addEventListener('resize', () => {
                    this.repositionNotes();
                });
            }

            repositionNotes() {
                const notes = this.container.querySelectorAll('.sticky-note');
                const viewportWidth = window.innerWidth;
                const viewportHeight = window.innerHeight;
                
                notes.forEach((note, index) => {
                    this.positionNote(note, index, viewportWidth, viewportHeight);
                });
            }
        }

        // Initialize the poetry scrapbook when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            new PoetryScrapbook();
        });
    </script>
</body>
</html>